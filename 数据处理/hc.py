import pandas as pd                         # 导入pandas包
import csv
import os
import re

filepath = "E:\大学学习\研究生\毕设\\data\\user"
for filename in os.listdir(filepath):
    filepath1 = filepath + "\\" + filename
    txtname = filepath1 + "\\" + "1.txt"
    with open(txtname,"r",encoding='utf-8') as fp:
        data = fp.readlines()
        length = len(data)
        csvname = filepath1 + "\\2.csv"
        csvFile = open(csvname, 'w', newline='', encoding='utf-8')
        writer = csv.writer(csvFile)
        writer.writerow(('cve-id', 'date1', 'date2', 'DESCR', 'vector',
                         'EXP'))
        for i in range(0,length):
            # print(data[i])
            cveid = data[i][:-1]
            # print(cveid)
            csvname1 = "E:\大学学习\研究生\毕设\\data\\fen\\" + cveid + ".csv"
            try:
                fppp = pd.read_csv(csvname1)
                date1 = fppp['date1'][0]
                # print(date1)
                date2 = fppp['date2'][0]
                DESCR = fppp['DESCR'][0]
                vector = fppp['vector'][0]
                exp = fppp['EXP'][0]
                writer.writerow((cveid, date1, date2, DESCR, vector,
                                 exp))
                # print(cveid)




            except:
                a=1


# data = pd.read_csv("E:\大学学习\大学学习\大三下\信安赛\数据源\结果合成\\last.csv")           	# 读取csv文件
# # data2 = pd.read_csv("E:\大学学习\大学学习\大三下\信安赛\数据源\结果合成\\cve-cvss.csv")           	# 读取csv文件
# csvFile = open("E:\大学学习\大学学习\大三下\信安赛\数据源\结果合成\\wanzheng.csv", 'w', newline='', encoding='utf-8')
#
# writer = csv.writer(csvFile)
# writer.writerow(('cve-id', 'cweone-hot', 'date1', 'date2', 'DESCR', 'onehot', 'vector',
#                      'Normalization001', 'Normalization002', 'Normalization003', 'Normalization004', 'Expliotion'))
#
# h = 0
# for i in range(0, len(data['CVE-ID'])):
#     a = data['CVE-ID'][i]
#
#     expliotion = data['Expliotion'][i]
#     # print(expliotion)
#     cveid = str(a)
#     csvname = "E:\大学学习\大学学习\大三下\信安赛\数据源\结果合成\\fenju\\" + cveid + ".csv"
#     # print(csvname)
#     try:
#         fppp = pd.read_csv(csvname)
#         # print(1)
#         try:
#             cweo = fppp['cweone-hot'][0]
#         except:
#             cweo = ""
#         try:
#             date1 = fppp['date1'][0]
#         except:
#             date1 = ""
#         try:
#             date2 = fppp["date2"][0]
#         except:
#             date2 = ""
#         try:
#             DESCR = fppp["DESCR"][0]
#         except:
#             DESCR = ""
#         try:
#             onehot = fppp["onehot"][0]
#         except:
#             onehot = ""
#         try:
#             vector = fppp["vector"][0]
#         except:
#             vector = ""
#         try:
#             Normalization001 = fppp["Normalization001"][0]
#         except:
#             Normalization001 = ""
#         try:
#             Normalization002 = fppp["Normalization002"][0]
#         except:
#             Normalization002 = ""
#         try:
#             Normalization003 = fppp["Normalization003"][0]
#         except:
#             Normalization003 = ""
#         try:
#             Normalization004 = fppp["Normalization004"][0]
#         except:
#             Normalization004 = ""
#
#         writer.writerow((cveid, cweo, date1, date2, DESCR, onehot, vector,
#                          Normalization001, Normalization002, Normalization003, Normalization004, expliotion))
#         # writer.writerow((cveid, cweo, date1, date2, DESCR, onehot, vector, Normalization001, Normalization002, Normalization003, Normalization004), exp[i])
#
#         # print(cveid, expliotion)
#     except:
#         print("chucuo")
#         h = h + 1
#
#
# print(h)



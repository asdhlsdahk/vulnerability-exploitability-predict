import pandas as pd
import csv
import os
bertloc = "E:\大学学习\研究生\毕设\\BERT\\bert128"
othervectorloc = "E:\大学学习\大学学习\大三下\信安赛\数据源\结果合成\\fenju"
exploc = "E:\大学学习\研究生\毕设\data\\fen"
# data = pd.read_csv(csvname)



# ------------------------读取bert--------------------------
for filename in os.listdir(bertloc):
    vec = []
    csvname = bertloc + "\\" + filename
    with open(csvname, mode='r', encoding='utf-8', newline='') as f:
        reader = csv.reader(f)
        for row in reader:
            a = 1
        bertdata = row[0]
        bertdatalist = row[0].split(" ")
        bertfloatlist = []
        for i in range(0, len(bertdatalist)):
            bertfloatlist.append(float(bertdatalist[i]))

    # --------------------找exp-----------------------------
    expname = exploc + "\\" + filename
    data = pd.read_csv(expname)
    exp1 = data["EXP"][0]

    # --------------------其他的参数-------------------------
    otherveccsv = othervectorloc + "\\" + filename
    data1 = pd.read_csv(otherveccsv)
    onehot = data1["onehot"][0]
    nor1 = data1["Normalization001"][0]
    nor2 = data1["Normalization002"][0]
    nor3 = data1["Normalization003"][0]
    nor4 = data1["Normalization004"][0]
    onehot = onehot.replace("\n", '')
    a = onehot[2:-2].split(". ")
    a[28] = a[28][:-1]
    onehotlist = []
    for j in range(0,29):
        onehotlist.append(float(a[j]))
    b = nor1[1:-2].split(". ")
    nor2list = []
    for h in range(0,5):
        nor2list.append(float(b[h]))

    vec = bertfloatlist
    vec.extend(onehotlist)
    vec.extend(nor2list)
    vec.append(float(nor2))
    vec.append(float(nor3))
    vec.append(float(nor4))
    # het = str(vec)
    # ------------------写-----------------------
    csvnamewrite = "E:\大学学习\研究生\毕设\BERT\\afterbert128\\" + filename
    csvFile = open(csvnamewrite, 'w', newline='', encoding='utf-8')
    writer = csv.writer(csvFile)
    writer.writerow(('cve-id', 'vec', 'exp'))
    writer.writerow((filename[:-4], vec, exp1))









